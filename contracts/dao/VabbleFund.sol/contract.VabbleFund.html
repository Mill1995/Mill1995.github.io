<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>VabbleFund</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../../favicon.svg">
        <link rel="shortcut icon" href="../../../favicon.png">
        <link rel="stylesheet" href="../../../css/variables.css">
        <link rel="stylesheet" href="../../../css/general.css">
        <link rel="stylesheet" href="../../../css/chrome.css">
        <link rel="stylesheet" href="../../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../../highlight.css">
        <link rel="stylesheet" href="../../../tomorrow-night.css">
        <link rel="stylesheet" href="../../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../../book.css">

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item "><a href="../../../index.html">Home</a></li><li class="chapter-item affix "><li class="part-title">contracts</li><li class="chapter-item expanded "><a href="../../../contracts/dao/index.html">❱ dao</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../contracts/dao/FactoryFilmNFT.sol/contract.FactoryFilmNFT.html">FactoryFilmNFT</a></li><li class="chapter-item "><a href="../../../contracts/dao/FactorySubNFT.sol/contract.FactorySubNFT.html">FactorySubNFT</a></li><li class="chapter-item "><a href="../../../contracts/dao/FactoryTierNFT.sol/contract.FactoryTierNFT.html">FactoryTierNFT</a></li><li class="chapter-item "><a href="../../../contracts/dao/Ownablee.sol/contract.Ownablee.html">Ownablee</a></li><li class="chapter-item "><a href="../../../contracts/dao/Property.sol/contract.Property.html">Property</a></li><li class="chapter-item "><a href="../../../contracts/dao/StakingPool.sol/contract.StakingPool.html">StakingPool</a></li><li class="chapter-item "><a href="../../../contracts/dao/Subscription.sol/contract.Subscription.html">Subscription</a></li><li class="chapter-item "><a href="../../../contracts/dao/UniHelper.sol/contract.UniHelper.html">UniHelper</a></li><li class="chapter-item "><a href="../../../contracts/dao/VabbleDAO.sol/contract.VabbleDAO.html">VabbleDAO</a></li><li class="chapter-item expanded "><a href="../../../contracts/dao/VabbleFund.sol/contract.VabbleFund.html" class="active">VabbleFund</a></li><li class="chapter-item "><a href="../../../contracts/dao/VabbleNFT.sol/contract.VabbleNFT.html">VabbleNFT</a></li><li class="chapter-item "><a href="../../../contracts/dao/Vote.sol/contract.Vote.html">Vote</a></li></ol></li><li class="chapter-item "><a href="../../../contracts/interfaces/index.html">❱ interfaces</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../contracts/interfaces/IFactoryFilmNFT.sol/interface.IFactoryFilmNFT.html">IFactoryFilmNFT</a></li><li class="chapter-item "><a href="../../../contracts/interfaces/IOwnablee.sol/interface.IOwnablee.html">IOwnablee</a></li><li class="chapter-item "><a href="../../../contracts/interfaces/IProperty.sol/interface.IProperty.html">IProperty</a></li><li class="chapter-item "><a href="../../../contracts/interfaces/IStakingPool.sol/interface.IStakingPool.html">IStakingPool</a></li><li class="chapter-item "><a href="../../../contracts/interfaces/IUniHelper.sol/interface.IUniHelper.html">IUniHelper</a></li><li class="chapter-item "><a href="../../../contracts/interfaces/IUniswapV2Factory.sol/interface.IUniswapV2Factory.html">IUniswapV2Factory</a></li><li class="chapter-item "><a href="../../../contracts/interfaces/IUniswapV2Router.sol/interface.IUniswapV2Router.html">IUniswapV2Router</a></li><li class="chapter-item "><a href="../../../contracts/interfaces/IVabbleDAO.sol/interface.IVabbleDAO.html">IVabbleDAO</a></li><li class="chapter-item "><a href="../../../contracts/interfaces/IVabbleFund.sol/interface.IVabbleFund.html">IVabbleFund</a></li><li class="chapter-item "><a href="../../../contracts/interfaces/IVote.sol/interface.IVote.html">IVote</a></li></ol></li><li class="chapter-item "><a href="../../../contracts/libraries/index.html">❱ libraries</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../contracts/libraries/Arrays.sol/library.Arrays.html">Arrays</a></li><li class="chapter-item "><a href="../../../contracts/libraries/Helper.sol/library.Helper.html">Helper</a></li></ol></li><li class="chapter-item "><a href="../../../contracts/mocks/index.html">❱ mocks</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../contracts/mocks/MockERC1155.sol/contract.MockERC1155.html">MockERC1155</a></li><li class="chapter-item "><a href="../../../contracts/mocks/MockERC20.sol/contract.MockERC20.html">MockERC20</a></li><li class="chapter-item "><a href="../../../contracts/mocks/MockERC721.sol/contract.MockERC721.html">MockERC721</a></li><li class="chapter-item "><a href="../../../contracts/mocks/MockUSDC.sol/contract.MockUSDC.html">MockUSDC</a></li><li class="chapter-item "><a href="../../../contracts/mocks/MockUSDT.sol/contract.MockUSDT.html">MockUSDT</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/Mill1995/VABDAO" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="vabblefund"><a class="header" href="#vabblefund">VabbleFund</a></h1>
<p><a href="https://github.com/Mill1995/VABDAO/blob/4914bdc306cbdb860037485ce4bcebbfdd390c9f/contracts/dao/VabbleFund.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="/contracts/interfaces/IVabbleFund.sol/interface.IVabbleFund.html">IVabbleFund</a>, ReentrancyGuard</p>
<p>VabbleFund contract handles the management of funds deposited for films in the Vabble ecosystem.</p>
<p><em>This contract facilitates the deposit, processing, and withdrawal of funds by investors for funding films.
Funds can be deposited in the form of tokens, and are managed based on specified film funding criteria.
Upon successful funding, rewards are distributed to the staking pool and remaining funds are transferred to the film
owner. Funding rewards for investors can be issued in the form of NFT's, tokens or both.</em></p>
<p><em>The contract interacts with other contracts including Ownable, StakingPool, UniHelper, Property, FactoryFilmNFT,
VabbleDAO, and various ERC20 tokens to achieve its functionalities.</em></p>
<p><em>It includes features for checking film funding status, managing investor lists, handling asset transfers,
and ensuring compliance with film-specific funding conditions such as minimum and maximum deposit amounts.</em></p>
<h2 id="state-variables"><a class="header" href="#state-variables">State Variables</a></h2>
<h3 id="ownable"><a class="header" href="#ownable">OWNABLE</a></h3>
<p><em>The address of the Ownable contract.</em></p>
<pre><code class="language-solidity">address private immutable OWNABLE;
</code></pre>
<h3 id="staking_pool"><a class="header" href="#staking_pool">STAKING_POOL</a></h3>
<p><em>The address of the StakingPool contract.</em></p>
<pre><code class="language-solidity">address private immutable STAKING_POOL;
</code></pre>
<h3 id="uni_helper"><a class="header" href="#uni_helper">UNI_HELPER</a></h3>
<p><em>The address of the UniHelper contract.</em></p>
<pre><code class="language-solidity">address private immutable UNI_HELPER;
</code></pre>
<h3 id="dao_property"><a class="header" href="#dao_property">DAO_PROPERTY</a></h3>
<p><em>The address of the Property contract.</em></p>
<pre><code class="language-solidity">address private immutable DAO_PROPERTY;
</code></pre>
<h3 id="film_nft"><a class="header" href="#film_nft">FILM_NFT</a></h3>
<p><em>The address of the FilmNftFactory contract.</em></p>
<pre><code class="language-solidity">address private immutable FILM_NFT;
</code></pre>
<h3 id="vabble_dao"><a class="header" href="#vabble_dao">VABBLE_DAO</a></h3>
<p>The address of the VabbleDAO contract.</p>
<pre><code class="language-solidity">address public VABBLE_DAO;
</code></pre>
<h3 id="fundprocessedfilmids"><a class="header" href="#fundprocessedfilmids">fundProcessedFilmIds</a></h3>
<p><em>List of film IDs that have processed funds.</em></p>
<pre><code class="language-solidity">uint256[] private fundProcessedFilmIds;
</code></pre>
<h3 id="filminvestorlist"><a class="header" href="#filminvestorlist">filmInvestorList</a></h3>
<p><em>Mapping from film ID to list of investor addresses.</em></p>
<pre><code class="language-solidity">mapping(uint256 =&gt; address[]) private filmInvestorList;
</code></pre>
<h3 id="assetperfilm"><a class="header" href="#assetperfilm">assetPerFilm</a></h3>
<p>Mapping from film ID to list of assets per film.</p>
<pre><code class="language-solidity">mapping(uint256 =&gt; Asset[]) public assetPerFilm;
</code></pre>
<h3 id="isfundprocessed"><a class="header" href="#isfundprocessed">isFundProcessed</a></h3>
<p>Mapping to check if fund is processed for a film.</p>
<pre><code class="language-solidity">mapping(uint256 =&gt; bool) public isFundProcessed;
</code></pre>
<h3 id="assetinfo"><a class="header" href="#assetinfo">assetInfo</a></h3>
<p>Mapping from film ID and customer address to list of assets.</p>
<pre><code class="language-solidity">mapping(uint256 =&gt; mapping(address =&gt; Asset[])) public assetInfo;
</code></pre>
<h3 id="allowusernftcount"><a class="header" href="#allowusernftcount">allowUserNftCount</a></h3>
<p><em>Mapping from film ID and user address to NFT count.</em></p>
<pre><code class="language-solidity">mapping(uint256 =&gt; mapping(address =&gt; uint256)) private allowUserNftCount;
</code></pre>
<h2 id="functions"><a class="header" href="#functions">Functions</a></h2>
<h3 id="onlydeployer"><a class="header" href="#onlydeployer">onlyDeployer</a></h3>
<p><em>Restricts access to the deployer of the Ownable contract.</em></p>
<pre><code class="language-solidity">modifier onlyDeployer();
</code></pre>
<h3 id="constructor"><a class="header" href="#constructor">constructor</a></h3>
<p>Initializes the contract with the given addresses.</p>
<pre><code class="language-solidity">constructor(address _ownable, address _uniHelper, address _staking, address _property, address _filmNftFactory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_ownable</code></td><td><code>address</code></td><td>The address of the Ownable contract.</td></tr>
<tr><td><code>_uniHelper</code></td><td><code>address</code></td><td>The address of the UniHelper contract.</td></tr>
<tr><td><code>_staking</code></td><td><code>address</code></td><td>The address of the StakingPool contract.</td></tr>
<tr><td><code>_property</code></td><td><code>address</code></td><td>The address of the DAO property contract.</td></tr>
<tr><td><code>_filmNftFactory</code></td><td><code>address</code></td><td>The address of the FilmNftFactory contract.</td></tr>
</tbody></table>
</div>
<h3 id="receive"><a class="header" href="#receive">receive</a></h3>
<pre><code class="language-solidity">receive() external payable;
</code></pre>
<h3 id="initialize"><a class="header" href="#initialize">initialize</a></h3>
<p>Initializes the VabbleDAO contract address.</p>
<pre><code class="language-solidity">function initialize(address _vabbleDAO) external onlyDeployer;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_vabbleDAO</code></td><td><code>address</code></td><td>The address of the Vabble DAO.</td></tr>
</tbody></table>
</div>
<h3 id="deposittofilm"><a class="header" href="#deposittofilm">depositToFilm</a></h3>
<p>Investors deposit tokens to fund a film.</p>
<pre><code class="language-solidity">function depositToFilm(uint256 _filmId, uint256 _amount, uint256 _flag, address _token) external payable nonReentrant;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_filmId</code></td><td><code>uint256</code></td><td>The ID of the film.</td></tr>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>The amount to deposit must be between the range of <code>Property::minDepositAmount</code> and <code>Property::maxDepositAmount</code>.</td></tr>
<tr><td><code>_flag</code></td><td><code>uint256</code></td><td>Indicates the type of deposit (1 for token, 2 for NFT).</td></tr>
<tr><td><code>_token</code></td><td><code>address</code></td><td>The address of the token to deposit.</td></tr>
</tbody></table>
</div>
<h3 id="fundprocess"><a class="header" href="#fundprocess">fundProcess</a></h3>
<p>Processes the funds for a film, transferring rewards to the staking pool and the remaining funds to the
film owner.</p>
<p><em>This function can only be called by the owner of the film and ensures the film has met the funding criteria.</em></p>
<pre><code class="language-solidity">function fundProcess(uint256 _filmId) external nonReentrant;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_filmId</code></td><td><code>uint256</code></td><td>The unique identifier of the film to process funds for. Requirements: - Caller must be the owner of the film. - Film must not have already been processed. - Film must be in the approved funding status. - The funding period must have ended. - The film must have raised the full required amount. Functionality: - Calculates and transfers the <code>Property::fundFeePercent</code> of the funds to the reward pool as VAB tokens. - Transfers the remaining funds to the film owner. - Marks the film as processed and emits a <code>FundFilmProcessed</code> event.</td></tr>
</tbody></table>
</div>
<h3 id="withdrawfunding"><a class="header" href="#withdrawfunding">withdrawFunding</a></h3>
<p>Allows an investor to withdraw their funds from a film if the funding period has ended and the film did
not meet its funding goal.</p>
<p><em>This function can only be called by investors who have deposited funds into the film.</em></p>
<pre><code class="language-solidity">function withdrawFunding(uint256 _filmId) external nonReentrant;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_filmId</code></td><td><code>uint256</code></td><td>The unique identifier of the film from which funds are being withdrawn. Requirements: - Film must be in the approved funding status. - The funding period must have ended. - The film must not have raised the full required amount. Functionality: - Transfers deposited tokens back to the investor. - If the investor's total fund amount for the film becomes zero after withdrawal, they are removed from the investor list. - Emits a <code>FundWithdrawed</code> event upon successful withdrawal.</td></tr>
</tbody></table>
</div>
<h3 id="getfundprocessedfilmidlist"><a class="header" href="#getfundprocessedfilmidlist">getFundProcessedFilmIdList</a></h3>
<p>Retrieves a list of film IDs that have successfully processed funds.</p>
<pre><code class="language-solidity">function getFundProcessedFilmIdList() external view returns (uint256[] memory);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256[]</code></td><td>List of values representing the film IDs that have completed the fund processing.</td></tr>
</tbody></table>
</div>
<h3 id="getfilminvestorlist"><a class="header" href="#getfilminvestorlist">getFilmInvestorList</a></h3>
<p>Returns the list of investors for a film.</p>
<pre><code class="language-solidity">function getFilmInvestorList(uint256 _filmId) external view override returns (address[] memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_filmId</code></td><td><code>uint256</code></td><td>The ID of the film.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address[]</code></td><td>List of investor addresses.</td></tr>
</tbody></table>
</div>
<h3 id="getallowusernftcount"><a class="header" href="#getallowusernftcount">getAllowUserNftCount</a></h3>
<p>Returns the allowed NFT count for an investor in a film.</p>
<pre><code class="language-solidity">function getAllowUserNftCount(uint256 _filmId, address _user) external view override returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_filmId</code></td><td><code>uint256</code></td><td>The ID of the film.</td></tr>
<tr><td><code>_user</code></td><td><code>address</code></td><td>The address of the investor.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The allowed NFT count.</td></tr>
</tbody></table>
</div>
<h3 id="israisedfullamount"><a class="header" href="#israisedfullamount">isRaisedFullAmount</a></h3>
<p>Checks if the film funding has met the raise amount.</p>
<pre><code class="language-solidity">function isRaisedFullAmount(uint256 _filmId) public view override returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_filmId</code></td><td><code>uint256</code></td><td>The ID of the film.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>True if the raise amount is met, false otherwise.</td></tr>
</tbody></table>
</div>
<h3 id="getuserfundamountperfilm"><a class="header" href="#getuserfundamountperfilm">getUserFundAmountPerFilm</a></h3>
<p>Returns the fund amount for an investor in a film.</p>
<pre><code class="language-solidity">function getUserFundAmountPerFilm(address _customer, uint256 _filmId) public view override returns (uint256 amount_);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_customer</code></td><td><code>address</code></td><td>The address of the investor.</td></tr>
<tr><td><code>_filmId</code></td><td><code>uint256</code></td><td>The ID of the film.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>amount_</code></td><td><code>uint256</code></td><td>The fund amount in USDC.</td></tr>
</tbody></table>
</div>
<h3 id="gettotalfundamountperfilm"><a class="header" href="#gettotalfundamountperfilm">getTotalFundAmountPerFilm</a></h3>
<p>Returns the total fund amount for a film.</p>
<pre><code class="language-solidity">function getTotalFundAmountPerFilm(uint256 _filmId) public view override returns (uint256 amount_);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_filmId</code></td><td><code>uint256</code></td><td>The ID of the film.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>amount_</code></td><td><code>uint256</code></td><td>The total fund amount in USDC.</td></tr>
</tbody></table>
</div>
<h3 id="__getexpectedtokenamount"><a class="header" href="#__getexpectedtokenamount">__getExpectedTokenAmount</a></h3>
<p>Returns the token amount equivalent to the given USDC amount.</p>
<pre><code class="language-solidity">function __getExpectedTokenAmount(address _token, uint256 _usdcAmount) public view returns (uint256 amount_);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_token</code></td><td><code>address</code></td><td>The address of the token.</td></tr>
<tr><td><code>_usdcAmount</code></td><td><code>uint256</code></td><td>The amount in USDC.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>amount_</code></td><td><code>uint256</code></td><td>The equivalent token amount.</td></tr>
</tbody></table>
</div>
<h3 id="__getexpectedusdcamount"><a class="header" href="#__getexpectedusdcamount">__getExpectedUsdcAmount</a></h3>
<p>Returns the USDC amount equivalent to the given token amount.</p>
<pre><code class="language-solidity">function __getExpectedUsdcAmount(address _token, uint256 _tokenAmount) public view returns (uint256 amount_);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_token</code></td><td><code>address</code></td><td>The address of the token.</td></tr>
<tr><td><code>_tokenAmount</code></td><td><code>uint256</code></td><td>The amount of the token.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>amount_</code></td><td><code>uint256</code></td><td>The equivalent USDC amount.</td></tr>
</tbody></table>
</div>
<h3 id="__deposittofilm"><a class="header" href="#__deposittofilm">__depositToFilm</a></h3>
<p><em>Deposits an amount to a film based on specified parameters.</em></p>
<p>*Function to deposit funds to a film based on specified conditions.</p>
<ul>
<li>Requires proper authorization based on the fund type and token/NFT availability.</li>
<li>Ensures the deposited amount meets minimum and maximum deposit criteria.*</li>
</ul>
<pre><code class="language-solidity">function __depositToFilm(
    uint256 _filmId,
    uint256 _amount,
    uint256 _flag,
    uint256 _fundType,
    uint256 _userFundAmount,
    address _token
)
    private
    returns (uint256 tokenAmount_);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_filmId</code></td><td><code>uint256</code></td><td>The ID of the film to deposit funds into.</td></tr>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>The amount to deposit.</td></tr>
<tr><td><code>_flag</code></td><td><code>uint256</code></td><td>A flag indicating the type of funding operation: - 1 for token-based funding. - 2 for NFT-based funding.</td></tr>
<tr><td><code>_fundType</code></td><td><code>uint256</code></td><td>The type of funding: - 1 for token funding. - 2 for NFT funding. - 3 for NFT &amp; token funding.</td></tr>
<tr><td><code>_userFundAmount</code></td><td><code>uint256</code></td><td>The current total funds deposited by the user for the film.</td></tr>
<tr><td><code>_token</code></td><td><code>address</code></td><td>The address of the token used for funding.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>tokenAmount_</code></td><td><code>uint256</code></td><td>The amount of tokens or NFTs deposited.</td></tr>
</tbody></table>
</div>
<h3 id="__assigntoken"><a class="header" href="#__assigntoken">__assignToken</a></h3>
<p><em>Assigns a token amount to the user's funding information for a specific film.</em></p>
<p><em>Function to update or add the token amount for the user's funding information.</em></p>
<pre><code class="language-solidity">function __assignToken(uint256 _filmId, address _token, uint256 _amount) private;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_filmId</code></td><td><code>uint256</code></td><td>The ID of the film.</td></tr>
<tr><td><code>_token</code></td><td><code>address</code></td><td>The address of the token.</td></tr>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>The amount of tokens to assign.</td></tr>
</tbody></table>
</div>
<h3 id="__removefilminvestorlist"><a class="header" href="#__removefilminvestorlist">__removeFilmInvestorList</a></h3>
<p><em>Removes a user from the investor list for a specific film.</em></p>
<pre><code class="language-solidity">function __removeFilmInvestorList(uint256 _filmId, address _user) private;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_filmId</code></td><td><code>uint256</code></td><td>The ID of the film.</td></tr>
<tr><td><code>_user</code></td><td><code>address</code></td><td>The address of the user to remove.</td></tr>
</tbody></table>
</div>
<h3 id="__isoverminamount"><a class="header" href="#__isoverminamount">__isOverMinAmount</a></h3>
<p><em>Checks if the amount is over the minimum deposit amount allowed for a film.</em></p>
<pre><code class="language-solidity">function __isOverMinAmount(uint256 _amount) private view returns (bool passed_);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>The amount to check.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>passed_</code></td><td><code>bool</code></td><td>True if the amount meets or exceeds the minimum deposit amount, otherwise false.</td></tr>
</tbody></table>
</div>
<h3 id="__islessmaxamount"><a class="header" href="#__islessmaxamount">__isLessMaxAmount</a></h3>
<p><em>Checks if the amount is less than or equal to the maximum deposit amount allowed for a film.</em></p>
<pre><code class="language-solidity">function __isLessMaxAmount(uint256 _amount) private view returns (bool passed_);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>The amount to check.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>passed_</code></td><td><code>bool</code></td><td>True if the amount is within the maximum deposit amount, otherwise false.</td></tr>
</tbody></table>
</div>
<h2 id="events"><a class="header" href="#events">Events</a></h2>
<h3 id="depositedtofilm"><a class="header" href="#depositedtofilm">DepositedToFilm</a></h3>
<p>Emitted when tokens are deposited to a film.</p>
<pre><code class="language-solidity">event DepositedToFilm(address indexed customer, uint256 indexed filmId, address token, uint256 amount, uint256 flag);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>customer</code></td><td><code>address</code></td><td>The address of the investor.</td></tr>
<tr><td><code>filmId</code></td><td><code>uint256</code></td><td>The ID of the film.</td></tr>
<tr><td><code>token</code></td><td><code>address</code></td><td>The address of the token deposited.</td></tr>
<tr><td><code>amount</code></td><td><code>uint256</code></td><td>The amount of tokens deposited.</td></tr>
<tr><td><code>flag</code></td><td><code>uint256</code></td><td>Indicates the type of deposit (1 for token, 2 for NFT).</td></tr>
</tbody></table>
</div>
<h3 id="fundfilmprocessed"><a class="header" href="#fundfilmprocessed">FundFilmProcessed</a></h3>
<p>Emitted when the funding for a film is processed.</p>
<pre><code class="language-solidity">event FundFilmProcessed(uint256 indexed filmId, address indexed studio);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>filmId</code></td><td><code>uint256</code></td><td>The ID of the film.</td></tr>
<tr><td><code>studio</code></td><td><code>address</code></td><td>The address of the studio.</td></tr>
</tbody></table>
</div>
<h3 id="fundwithdrawed"><a class="header" href="#fundwithdrawed">FundWithdrawed</a></h3>
<p>Emitted when funds are withdrawn from a film when the funding failed.</p>
<pre><code class="language-solidity">event FundWithdrawed(uint256 indexed filmId, address indexed customer);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>filmId</code></td><td><code>uint256</code></td><td>The ID of the film.</td></tr>
<tr><td><code>customer</code></td><td><code>address</code></td><td>The address of the investor.</td></tr>
</tbody></table>
</div>
<h2 id="structs"><a class="header" href="#structs">Structs</a></h2>
<h3 id="asset"><a class="header" href="#asset">Asset</a></h3>
<p>Represents an asset with its token address and amount.</p>
<pre><code class="language-solidity">struct Asset {
    address token;
    uint256 amount;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>token</code></td><td><code>address</code></td><td>The address of the token.</td></tr>
<tr><td><code>amount</code></td><td><code>uint256</code></td><td>The amount of the token.</td></tr>
</tbody></table>
</div>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../../contracts/dao/VabbleDAO.sol/contract.VabbleDAO.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../../contracts/dao/VabbleNFT.sol/contract.VabbleNFT.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../../contracts/dao/VabbleDAO.sol/contract.VabbleDAO.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../../contracts/dao/VabbleNFT.sol/contract.VabbleNFT.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../../elasticlunr.min.js"></script>
        <script src="../../../mark.min.js"></script>
        <script src="../../../searcher.js"></script>

        <script src="../../../clipboard.min.js"></script>
        <script src="../../../highlight.js"></script>
        <script src="../../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../../solidity.min.js"></script>


    </div>
    </body>
</html>
